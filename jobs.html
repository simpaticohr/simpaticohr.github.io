<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simpatico HR | Jobs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Plus Jakarta Sans', system-ui, -apple-system, sans-serif;
      background: #0a0f1e;
      color: #e2e8f0;
      min-height: 100vh;
    }

    /* â˜… Nav */
    .nav {
      backdrop-filter: blur(16px);
      background: rgba(10,15,30,0.9);
      padding: 1.2rem 6%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .logo {
      font-weight: 800;
      font-size: 1.1rem;
      color: #fff;
      text-decoration: none;
    }
    .logo span { color: #6366f1; }
    .nav-links { display: flex; gap: 16px; align-items: center; }
    .nav-link {
      color: #94a3b8;
      text-decoration: none;
      font-size: 13px;
      font-weight: 500;
      padding: 6px 14px;
      border-radius: 8px;
      transition: all 0.2s;
    }
    .nav-link:hover { color: #fff; background: rgba(255,255,255,0.05); }
    .nav-link.active { color: #fff; background: rgba(99,102,241,0.15); }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 50px 20px;
    }

    /* â˜… Header */
    .page-header {
      text-align: center;
      margin-bottom: 50px;
    }
    .page-header h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 800;
      background: linear-gradient(135deg, #fff, #94a3b8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 12px;
    }
    .page-header p {
      color: #64748b;
      font-size: 1.05rem;
      max-width: 500px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* â˜… Stats */
    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 32px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    .stat {
      text-align: center;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 16px;
      padding: 16px 28px;
    }
    .stat-num {
      font-size: 1.6rem;
      font-weight: 800;
      color: #6366f1;
    }
    .stat-label {
      font-size: 0.75rem;
      color: #64748b;
      margin-top: 2px;
    }

    /* â˜… Filters */
    .filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 30px;
      justify-content: center;
    }
    .filter-btn {
      padding: 8px 18px;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      background: transparent;
      color: #94a3b8;
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }
    .filter-btn:hover { border-color: rgba(99,102,241,0.3); color: #fff; }
    .filter-btn.active {
      background: rgba(99,102,241,0.15);
      border-color: rgba(99,102,241,0.4);
      color: #a5b4fc;
    }

    /* â˜… Search */
    .search-wrap {
      margin-bottom: 30px;
      position: relative;
    }
    .search-wrap i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #475569;
    }
    .search-input {
      width: 100%;
      padding: 14px 16px 14px 44px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      color: #e2e8f0;
      font-size: 0.95rem;
      outline: none;
      font-family: inherit;
      transition: border-color 0.2s;
    }
    .search-input:focus {
      border-color: rgba(99,102,241,0.4);
      box-shadow: 0 0 0 3px rgba(99,102,241,0.1);
    }
    .search-input::placeholder { color: #475569; }

    /* â˜… Job Card */
    .job-card {
      background: rgba(15,23,42,0.8);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 24px;
      margin-bottom: 20px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    .job-card:hover {
      border-color: rgba(99,102,241,0.3);
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(99,102,241,0.08);
    }

    .job-header {
      background: linear-gradient(135deg, rgba(99,102,241,0.15), rgba(139,92,246,0.1));
      padding: 24px 28px 18px;
      border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .job-header small {
      font-size: 0.72rem;
      color: #6366f1;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }
    .job-header h2 {
      font-size: 1.4rem;
      font-weight: 700;
      margin-top: 6px;
      color: #f1f5f9;
    }

    .job-body {
      padding: 24px 28px;
    }

    .job-meta {
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }
    .job-meta-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.82rem;
      color: #94a3b8;
    }
    .job-meta-item i {
      color: #6366f1;
      font-size: 0.8rem;
    }

    .job-desc {
      color: #94a3b8;
      font-size: 0.9rem;
      line-height: 1.7;
      margin-bottom: 18px;
    }

    .job-skills {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 20px;
    }
    .skill-tag {
      background: rgba(99,102,241,0.1);
      color: #a5b4fc;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .job-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
    }

    .job-level {
      font-size: 0.78rem;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: 8px;
    }
    .level-fresher { background: rgba(16,185,129,0.12); color: #34d399; }
    .level-junior { background: rgba(59,130,246,0.12); color: #60a5fa; }
    .level-mid { background: rgba(99,102,241,0.12); color: #a5b4fc; }
    .level-senior { background: rgba(245,158,11,0.12); color: #fbbf24; }
    .level-lead { background: rgba(239,68,68,0.12); color: #f87171; }

    .apply-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #6366f1;
      color: #fff;
      padding: 12px 24px;
      border-radius: 14px;
      text-decoration: none;
      font-weight: 700;
      font-size: 0.9rem;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
      font-family: inherit;
    }
    .apply-btn:hover {
      transform: scale(1.03);
      box-shadow: 0 8px 24px rgba(99,102,241,0.3);
    }

    /* â˜… Empty state */
    .empty {
      text-align: center;
      padding: 60px 20px;
      color: #64748b;
    }
    .empty-icon {
      font-size: 3rem;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    /* â˜… Loading */
    .loading-wrap {
      text-align: center;
      padding: 60px 20px;
    }
    .spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 3px solid rgba(99,102,241,0.2);
      border-top-color: #6366f1;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-text {
      margin-top: 12px;
      color: #64748b;
      font-size: 0.9rem;
    }

    /* â˜… Footer */
    .footer {
      text-align: center;
      padding: 40px 0;
      margin-top: 60px;
      border-top: 1px solid rgba(255,255,255,0.04);
      font-size: 12px;
      color: #475569;
    }
    .footer a { color: #6366f1; text-decoration: none; }

    @media (max-width: 600px) {
      .container { padding: 30px 14px; }
      .job-header, .job-body { padding: 18px 20px; }
      .job-header h2 { font-size: 1.2rem; }
      .stats-bar { gap: 12px; }
      .stat { padding: 12px 18px; }
      .nav { padding: 1rem 4%; }
      .nav-links { gap: 8px; }
      .nav-link { font-size: 12px; padding: 5px 10px; }
    }
  </style>
</head>

<body>

<!-- â˜… NAV -->
<nav class="nav">
  <a class="logo" href="index.html">SIMPATICO <span>HR</span></a>
  <div class="nav-links">
    <a class="nav-link active" href="jobs.html">ğŸ’¼ Jobs</a>
    <a class="nav-link" href="career-lab.html">ğŸ§  Career Lab</a>
    <a class="nav-link" href="evalis-platform.html">ğŸ¤ Interview</a>
    <a class="nav-link" href="index.html">Home</a>
  </div>
</nav>

<div class="container">

  <!-- â˜… HEADER -->
  <div class="page-header">
    <h1>Current Openings</h1>
    <p>Find your next opportunity. Apply and get AI-screened instantly.</p>
  </div>

  <!-- â˜… STATS -->
  <div class="stats-bar">
    <div class="stat"><div class="stat-num" id="totalJobs">-</div><div class="stat-label">Open Positions</div></div>
    <div class="stat"><div class="stat-num" id="totalDepts">-</div><div class="stat-label">Departments</div></div>
    <div class="stat"><div class="stat-num">AI</div><div class="stat-label">ATS Screening</div></div>
  </div>

  <!-- â˜… SEARCH -->
  <div class="search-wrap">
    <i class="fa fa-search"></i>
    <input class="search-input" id="searchInput" type="text" placeholder="Search by title, skill, location...">
  </div>

  <!-- â˜… FILTERS -->
  <div class="filters" id="filterWrap">
    <button class="filter-btn active" onclick="filterJobs('all', this)">All</button>
    <button class="filter-btn" onclick="filterJobs('IT/Software', this)">ğŸ’» IT/Software</button>
    <button class="filter-btn" onclick="filterJobs('Accounting', this)">ğŸ“Š Accounting</button>
    <button class="filter-btn" onclick="filterJobs('Sales/Marketing', this)">ğŸ“ˆ Sales/Marketing</button>
    <button class="filter-btn" onclick="filterJobs('Management', this)">ğŸ‘” Management</button>
  </div>

  <!-- â˜… JOBS LIST -->
  <div id="jobsList">
    <div class="loading-wrap">
      <div class="spinner"></div>
      <div class="loading-text">Loading openings...</div>
    </div>
  </div>

</div>

<!-- â˜… FOOTER -->
<div class="footer">
  Â© 2025 <a href="index.html">Simpatico HR Consultancy</a> â€¢ AI-Powered Recruitment
</div>

<script>
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // â˜… DIRECT SUPABASE CONNECTION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const SUPABASE_URL = "https://cvkxtsvgnynxexmemfuy.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2a3h0c3ZnbnlueGV4bWVtZnV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc0MjE2NTEsImV4cCI6MjA4Mjk5NzY1MX0.2mys8Cc-ucJ1uLThEGJubeDEg1TvfIAkW-xFsR4ecq4";

  let allJobs = [];
  let currentFilter = 'all';

  async function supabaseGet(table, filters = {}) {
    let url = `${SUPABASE_URL}/rest/v1/${table}?`;
    for (const [key, val] of Object.entries(filters)) {
      url += `${key}=eq.${val}&`;
    }
    url += `order=created_at.desc`;
    const res = await fetch(url, {
      headers: {
        "apikey": SUPABASE_KEY,
        "Authorization": "Bearer " + SUPABASE_KEY
      }
    });
    return await res.json();
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Load Jobs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  async function loadJobs() {
    const el = document.getElementById("jobsList");

    try {
      const data = await supabaseGet('jobs', { is_active: true });

      if (!data || data.error || !Array.isArray(data) || data.length === 0) {
        el.innerHTML = `
          <div class="empty">
            <div class="empty-icon">ğŸ“­</div>
            <h3 style="margin-bottom:8px;">No openings right now</h3>
            <p>Check back soon â€” new positions are added regularly.</p>
          </div>`;
        return;
      }

      allJobs = data;
      renderJobs(allJobs);

      document.getElementById('totalJobs').textContent = data.length;
      const depts = [...new Set(data.map(j => j.department || j.category || 'General'))];
      document.getElementById('totalDepts').textContent = depts.length;

    } catch (err) {
      console.error(err);
      el.innerHTML = `
        <div class="empty">
          <div class="empty-icon">âš ï¸</div>
          <h3>Error loading jobs</h3>
          <p style="color:#f87171;">${err.message}</p>
          <button class="apply-btn" style="margin-top:16px;" onclick="loadJobs()">ğŸ”„ Retry</button>
        </div>`;
    }
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Render Jobs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function renderJobs(jobs) {
    const el = document.getElementById("jobsList");

    if (!jobs.length) {
      el.innerHTML = `
        <div class="empty">
          <div class="empty-icon">ğŸ”</div>
          <h3>No matching jobs found</h3>
          <p>Try a different search or filter.</p>
        </div>`;
      return;
    }

    el.innerHTML = jobs.map(job => {
      const levelClass = {
        'Fresher': 'level-fresher',
        'Junior': 'level-junior',
        'Mid-Level': 'level-mid',
        'Senior': 'level-senior',
        'Lead': 'level-lead'
      }[job.level] || 'level-mid';

      const skills = job.skills || [];
      const company = job.company_name || "Simpatico HR";
      const location = job.location || "Remote";
      const dept = job.department || job.category || "General";
      const level = job.level || "Mid-Level";
      const desc = job.description || "Role details will be shared during the interview process.";
      const atsThreshold = job.ats_threshold || 0;

      return `
        <div class="job-card">
          <div class="job-header">
            <small>NOW HIRING</small>
            <h2>${job.title || 'Untitled Position'}</h2>
          </div>
          <div class="job-body">
            <div class="job-meta">
              <div class="job-meta-item"><i class="fa fa-building"></i>${company}</div>
              <div class="job-meta-item"><i class="fa fa-briefcase"></i>${dept}</div>
              <div class="job-meta-item"><i class="fa fa-location-dot"></i>${location}</div>
              ${atsThreshold > 0 ? `<div class="job-meta-item"><i class="fa fa-robot"></i>AI Screening</div>` : ''}
            </div>
            <p class="job-desc">${desc.length > 250 ? desc.substring(0, 250) + '...' : desc}</p>
            ${skills.length ? `<div class="job-skills">${skills.map(s => `<span class="skill-tag">${s}</span>`).join('')}</div>` : ''}
            <div class="job-footer">
              <span class="job-level ${levelClass}">${level}</span>
              <a class="apply-btn" href="career.html?job_id=${job.id}">
                Apply Now <i class="fa fa-arrow-right"></i>
              </a>
            </div>
          </div>
        </div>`;
    }).join('');
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Filter & Search
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function filterJobs(category, btn) {
    currentFilter = category;
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    applyFilters(category, document.getElementById('searchInput').value.toLowerCase());
  }

  function applyFilters(category, searchTerm) {
    let filtered = allJobs;
    if (category !== 'all') {
      filtered = filtered.filter(j =>
        (j.category || '').toLowerCase() === category.toLowerCase() ||
        (j.department || '').toLowerCase() === category.toLowerCase()
      );
    }
    if (searchTerm) {
      filtered = filtered.filter(j => {
        const text = [j.title, j.description, j.department, j.category, j.location, j.level, ...(j.skills || [])]
          .filter(Boolean).join(' ').toLowerCase();
        return text.includes(searchTerm);
      });
    }
    renderJobs(filtered);
  }

  let searchTimeout;
  document.getElementById('searchInput').addEventListener('input', (e) => {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => {
      applyFilters(currentFilter, e.target.value.toLowerCase());
    }, 300);
  });

  // Init
  loadJobs();
</script>

</body>
</html>
