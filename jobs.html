<script>
    const SUPABASE_URL = "https://cvkxtsvgnynxexmemfuy.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2a3h0c3ZnbnlueGV4bWVtZnV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc0MjE2NTEsImV4cCI6MjA4Mjk5NzY1MX0.2mys8Cc-ucJ1uLThEGJubeDEg1TvfIAkW-xFsR4ecq4";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function fetchJobs() {
        const container = document.getElementById("jobList");
        
        try {
            const { data: jobs, error } = await supabase
                .from("jobs")
                .select("*")
                .eq("is_active", true);

            if (error) {
                container.innerHTML = `<p class='loading-msg' style='color:red;'>Connection Error: ${error.message}</p>`;
                return;
            }

            if (!jobs || jobs.length === 0) {
                container.innerHTML = "<p class='loading-msg'>No active job openings found.</p>";
                return;
            }

            container.innerHTML = ""; // Clear "Fetching..." message

            jobs.forEach(job => {
                container.innerHTML += `
                    <div class="job-card">
                        <h3>${job.title || 'Untitled Position'}</h3>
                        <p><strong>Location:</strong> ${job.location || 'Remote'}</p>
                        <p><strong>Department:</strong> ${job.department || 'General'}</p>
                        <a href="apply.html?job_id=${job.id}" class="apply-btn">Apply Now</a>
                    </div>`;
            });
        } catch (err) {
            container.innerHTML = `<p class='loading-msg'>Error: Make sure you are connected to the internet.</p>`;
        }
    }

    fetchJobs();
</script>

