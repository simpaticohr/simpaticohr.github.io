<!-- SUPABASE SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  const SUPABASE_URL = "https://cvkxtsvgnynxexmemfuy.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2a3h0c3ZnbnlueGV4bWVtZnV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc0MjE2NTEsImV4cCI6MjA4Mjk5NzY1MX0.2mys8Cc-ucJ1uLThEGJubeDEg1TvfIAkW-xFsR4ecq4";

  const supabase = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );
</script>

<div class="job-container" style="max-width: 800px; margin: 40px auto; padding: 0 20px;">
  <div class="modern-card" style="background: white; border-radius: 24px; overflow: hidden; box-shadow: 0 20px 40px rgba(0,45,90,0.1); border: 1px solid #e1e8f0;">
    
    <!-- HEADER -->
    <div style="height: 120px; background: linear-gradient(135deg, #002d5a 0%, #00c2ff 100%); padding: 30px;">
      <span style="background: rgba(255,255,255,0.2); color: white; padding: 6px 16px; border-radius: 50px; font-size: 12px; font-weight: 600;">
        Now Hiring
      </span>
      <h2 style="color: white; margin-top: 15px;">HR Intern (Freshers)</h2>
    </div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  // üîê Replace these with YOUR values
  const SUPABASE_URL = "https://cvkxtsvgnynxexmemfuy.supabase.co";
  const SUPABASE_ANON_KEY = "PASTE_YOUR_ANON_KEY_HERE";

  const supabase = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );

  async function loadJobs() {
    const { data, error } = await supabase
      .from("jobs")
      .select("*")
      .eq("is_active", true);

    if (error) {
      console.error(error);
      document.getElementById("jobs").innerHTML =
        "<p>Failed to load jobs</p>";
      return;
    }

    if (!data.length) {
      document.getElementById("jobs").innerHTML =
        "<p>No open positions</p>";
      return;
    }

    document.getElementById("jobs").innerHTML = data.map(job => `
      <div class="modern-card" style="margin-bottom:30px;">
        <h3>${job.title}</h3>
        <p><strong>Department:</strong> ${job.department || "-"}</p>
        <p><strong>Location:</strong> ${job.location || "Remote"}</p>
        <p>${job.description || ""}</p>
        <a href="career.html?job=${job.id}">Apply Now</a>
      </div>
    `).join("");
  }

  loadJobs();
</script>
    <!-- BODY -->
    <div style="padding: 40px;">
      <p style="color:#555">
        Join Simpatico HR's elite 2026 talent program.
      </p>

      <hr style="margin:30px 0">

      <h4>Quick Apply</h4>

      <form id="applyForm" style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
        
        <input type="hidden" id="job_id" value="baada626-3367-4aed-82c4-27c818cba345">

        <div>
          <label>Full Name</label>
          <input id="full_name" required style="width:100%;padding:12px;border-radius:10px;border:1px solid #ccc">
        </div>

        <div>
          <label>Email</label>
          <input id="email" type="email" required style="width:100%;padding:12px;border-radius:10px;border:1px solid #ccc">
        </div>

        <div style="grid-column:span 2">
          <label>CV / Portfolio Link</label>
          <input id="resume_url" type="url" required style="width:100%;padding:12px;border-radius:10px;border:1px solid #ccc">
        </div>

        <div style="grid-column:span 2">
          <button type="submit" style="width:100%;padding:16px;background:#002d5a;color:white;border:none;border-radius:12px;font-weight:700">
            Submit Application
          </button>
        </div>

        <p id="status" style="grid-column:span 2;color:green;font-weight:600"></p>

      </form>
    </div>
  </div>
</div>

<script>
document.getElementById("applyForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const status = document.getElementById("status");
  status.textContent = "Submitting...";

  const { error } = await supabase
    .from("candidates")
    .insert([{
      full_name: document.getElementById("full_name").value,
      email: document.getElementById("email").value,
      resume_url: document.getElementById("resume_url").value,
      job_id: document.getElementById("job_id").value,
      status: "applied"
    }]);

  if (error) {
    status.style.color = "red";
    status.textContent = "Submission failed";
    console.error(error);
  } else {
    status.style.color = "green";
    status.textContent = "Application submitted successfully ‚úÖ";
    e.target.reset();
  }
});
</script>
