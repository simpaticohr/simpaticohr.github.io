<!DOCTYPE html>
<html>
<head>
  <title>My Applications | Simpatico HR</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="font-family:system-ui;padding:30px">

<h2>My Applications</h2>
<p id="status">Checking loginâ€¦</p>

<div id="apps"></div>

<script>
const supabase = supabase.createClient(
  "https://cvkxtsvgnynxexmemfuy.supabase.co",
  "YOUR_ANON_KEY"
);

async function load() {
  const { data: { user } } = await supabase.auth.getUser();
  if (!user) {
    document.getElementById("status").innerText =
      "Login required. Check your email.";
    return;
  }

  document.getElementById("status").innerText =
    "Logged in as " + user.email;

  const { data } = await supabase
    .from("candidates")
    .select("status, jobs(title)")
    .eq("email", user.email);

  document.getElementById("apps").innerHTML =
    data.map(a => `
      <p>
        <b>${a.jobs.title}</b><br>
        Status: ${a.status}
      </p>
    `).join("");
}

load();
</script>
</body>
</html>
