<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Evalis Interview</title>

<style>
body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at center, #0b1a3a, #020617);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: system-ui, sans-serif;
  color: white;
}

.card {
  background: rgba(255,255,255,0.05);
  padding: 24px 28px;
  border-radius: 14px;
  text-align: center;
  width: 300px;
}

.circle {
  width: 70px;
  height: 70px;
  margin: 0 auto 16px;
  border-radius: 50%;
  background: #3b82f6;
}

button {
  margin-top: 14px;
  padding: 10px 16px;
  border-radius: 20px;
  border: none;
  background: #2563eb;
  color: white;
  font-size: 14px;
}
</style>
</head>

<body>

<div class="card">
  <div class="circle"></div>
  <div id="question">Ready to start interview</div>
  <div id="status" style="opacity:.7;margin-top:6px;"></div>
  <button id="startBtn">Start Interview</button>
</div>

<script>
(function () {

  const questionEl = document.getElementById("question");
  const statusEl = document.getElementById("status");
  const startBtn = document.getElementById("startBtn");

  if (!questionEl || !statusEl || !startBtn) {
    document.body.innerHTML = "<h2 style='color:white'>UI load failed</h2>";
    return;
  }

  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

  if (!SpeechRecognition) {
    statusEl.textContent = "Speech not supported on this browser";
    startBtn.disabled = true;
    return;
  }

  const questions = [
    "Tell me about yourself.",
    "What skills did you use in your last role?",
    "What was your personal contribution?",
    "What challenges did you face?",
    "What was the outcome?"
  ];

  let index = 0;
  let recognition;

  function speak(text) {
    speechSynthesis.cancel();
    questionEl.textContent = text;
    statusEl.textContent = "Speaking…";

    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "en-US";

    utter.onend = () => listen();
    speechSynthesis.speak(utter);
  }

  function listen() {
    recognition = new SpeechRecognition();
    recognition.lang = "en-US";
    recognition.continuous = false;

    statusEl.textContent = "Listening…";

    recognition.onresult = e => {
      recognition.stop();
      index++;
      if (index < questions.length) {
        speak(questions[index]);
      } else {
        questionEl.textContent = "Interview completed";
        statusEl.textContent = "";
      }
    };

    recognition.onerror = () => {
      statusEl.textContent = "Retrying…";
      setTimeout(listen, 800);
    };

    recognition.start();
  }

  startBtn.onclick = () => {
    startBtn.style.display = "none";
    index = 0;
    speak(questions[0]);
  };

})();
</script>

</body>
</html>
