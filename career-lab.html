<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Career Lab | Simpatico HR</title>

<!-- ✅ REQUIRED FOR MIC IN IFRAME -->
<meta http-equiv="Permissions-Policy" content="microphone=*, autoplay=*">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<style>
:root {
  --primary:#002d5a;
  --tech:#00c2ff;
  --dark:#020617;
}

body {
  margin:0;
  background:#f4f8fb;
  font-family:'Poppins',sans-serif;
}

.nav {
  background:var(--primary);
  padding:15px 5%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:white;
}

.nav a {
  color:white;
  text-decoration:none;
  font-weight:600;
}

.main {
  max-width:1000px;
  margin:auto;
  padding:40px 20px;
  display:flex;
  flex-direction:column;
  gap:40px;
}

.card {
  background:white;
  padding:40px;
  border-radius:24px;
  box-shadow:0 10px 40px rgba(0,0,0,.05);
  text-align:center;
}

.btn {
  width:100%;
  padding:16px;
  border-radius:12px;
  border:none;
  background:var(--primary);
  color:white;
  font-weight:700;
  cursor:pointer;
}

.interview-section {
  background:white;
  border-radius:30px;
  overflow:hidden;
  box-shadow:0 20px 50px rgba(0,0,0,.08);
}

.interview-head {
  padding:30px;
}

.iframe-wrap {
  height:600px;
  background:var(--dark);
}

iframe {
  width:100%;
  height:100%;
  border:none;
}
</style>
</head>

<body>

<div class="nav">
  <a href="index.html">SIMPATICO HR</a>
  <a href="index.html"><i class="fa-solid fa-house"></i> Home</a>
</div>

<div class="main">

  <!-- ================= CV AUDIT ================= -->
  <div class="card">
    <h2>AI CV Audit</h2>
    <p style="color:#64748b">Upload your CV to test ATS readiness</p>

    <input type="file" id="cvInput" accept="application/pdf" hidden>
    <button class="btn" onclick="document.getElementById('cvInput').click()">
      <i class="fa-solid fa-file-arrow-up"></i> Select PDF CV
    </button>

    <div id="result" style="display:none;margin-top:25px">
      <h3>Your ATS Score</h3>
      <div style="font-size:3rem;font-weight:800;color:#e74c3c" id="score">0%</div>
    </div>
  </div>

  <!-- ================= INTERVIEW ================= -->
  <div class="interview-section">
    <div class="interview-head">
      <h3><i class="fa-solid fa-headset" style="color:var(--tech)"></i> Evalis AI Interview</h3>
      <p style="color:#64748b;font-size:14px">
        Practice your voice-guided interview with Evalis AI
      </p>
    </div>

    <div class="iframe-wrap">
      <!-- ✅ FIXED IFRAME -->
      <iframe
        src="https://simpaticohr.github.io/evalis-interview.html"
        title="Evalis AI Interview"
        allow="microphone; autoplay; clipboard-write"
        allowfullscreen
        referrerpolicy="no-referrer">
      </iframe>
    </div>

    <div style="padding:15px;text-align:center;font-size:11px;color:#94a3b8">
      <i class="fa-solid fa-shield-halved"></i> Privacy Protected &nbsp; • &nbsp;
      <i class="fa-solid fa-bolt"></i> Real-time AI Analysis
    </div>
  </div>

</div>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

document.getElementById("cvInput").onchange = async e => {
  const file = e.target.files[0];
  if (!file) return;

  const pdf = await pdfjsLib.getDocument(await file.arrayBuffer()).promise;
  const page = await pdf.getPage(1);
  const text = (await page.getTextContent()).items.map(i=>i.str).join(" ").toLowerCase();

  let score = 20;
  ["experience","skills","project","education"].forEach(k=>{
    if(text.includes(k)) score+=15;
  });

  document.getElementById("score").innerText = Math.min(score,85) + "%";
  document.getElementById("result").style.display = "block";
};
</script>

</body>
</html>
